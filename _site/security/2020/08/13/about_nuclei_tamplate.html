<!DOCTYPE html>
<html lang="en">

<head><meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<link href="https://fonts.googleapis.com/css?family=Merriweather:300|Raleway:400,700" rel="stylesheet">
<link rel="stylesheet" href="/assets/css/style.css">
<title>Let's make Nuclei Template</title>
<!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Let’s make Nuclei Template | Dexter_H</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Let’s make Nuclei Template" />
<meta name="author" content="Dexter_H" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="There Is More Then One Way To Do It" />
<meta property="og:description" content="There Is More Then One Way To Do It" />
<link rel="canonical" href="http://localhost:4000/security/2020/08/13/about_nuclei_tamplate.html" />
<meta property="og:url" content="http://localhost:4000/security/2020/08/13/about_nuclei_tamplate.html" />
<meta property="og:site_name" content="Dexter_H" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-08-13T03:00:00+09:00" />
<script type="application/ld+json">
{"@type":"BlogPosting","url":"http://localhost:4000/security/2020/08/13/about_nuclei_tamplate.html","headline":"Let’s make Nuclei Template","dateModified":"2020-08-13T03:00:00+09:00","datePublished":"2020-08-13T03:00:00+09:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/security/2020/08/13/about_nuclei_tamplate.html"},"author":{"@type":"Person","name":"Dexter_H"},"description":"There Is More Then One Way To Do It","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
</head>

<body>
  <main class="container">
    <section class="about">
      <a href="/"><img src="/assets/portfolio.png" alt="Dexter_H"></a>
      <h2 id="title">
        <a href="/">Dexter_H</a>
      </h2>
      <p class="tagline">BugHunter, Gambler</p>
      <ul class="social"><a href="https://github.com/dexter-sec" target="_blank">
          <li>
            <i class="icon-github-circled"></i>
          </li>
        </a></ul><a href="/portal.html"> portal </a>
      <p>&copy;
        2020</p><div>
        <p>Dark Mode
          <i class="icon-moon"></i>
          <label class="switch">
            <input type="checkbox" id="dark-mode-toggle">
            <span class="slider round" onclick="toggleDarkMode()"></span>
          </label>
        </p>
      </div>
      <script type="text/javascript" src="/assets/js/darkmode.js"></script></section>
    <section class="content">
      <div class="post-container">
  <a class="post-link" href="/security/2020/08/13/about_nuclei_tamplate.html">
    <h2 class="post-title">Let&#39;s make Nuclei Template</h2>
  </a>
  <div class="post-meta">
    <div class="post-date"><i class="icon-calendar"></i>Aug 13, 2020</div><ul class="post-categories"><li>Security</li></ul></div>
  <div style="text-align: left;">
	<a href="http://hits.dwyl.com/localhost:4000/security-2020-08-13-about_nuclei_tamplate.html" target="_blank">
	  <img src="http://hits.dwyl.com/localhost:4000/security-2020-08-13-about_nuclei_tamplate.html.svg" />
	</a>
  </div> 
  <div class="post">

  
    
      <span class="tag">#tool</span>
    
  
    
      <span class="tag">#bugbounty</span>
    
  


	<p><img src="/assets/nuclei-logo.png" alt="Nuclei_logo" /></p>

<p>https://github.com/projectdiscovery/nuclei
<br />
<br />
<br /></p>
<h3 id="about-nuclei">About Nuclei</h3>
<p>Nuclei는 projectdiscovery의 브랜치로 대규모 확장성과 사용 편의성을 제공하는 템플릿을 기반으로 구성 가능한 대상 스캔을 위한 빠른 도구로 GO로 작성되어 있다.</p>

<p>사실 단순 http-go만으로 작성된 request 툴이라면, 그리 매력적인 도구는 아니지만, 
<br /></p>
<ul>
  <li>*.yaml로 작성하여 사용 가능한 커스텀 템플릿의 확장성이 좋다.</li>
  <li>오픈 소스인 만큼 templete pull을 해주는 Contributors가 있고, 템플릿의 규모가 커지고 있다.</li>
  <li>취약점 점검, 버그 바운티, 서비스 리콘 이외 이모조모 쓸모가 많으며, 자동화 도구 워크 플로우랑 궁합(?)이 좋다.
<br />
<br /></li>
</ul>

<p><img src="/assets/nuclei_templete.png" alt="Nuclei_templete" /></p>

<p>nuclei templet(https://github.com/projectdiscovery/nuclei-templates)에는 (20.08.13기준) 13개 카타고리에 204개 템플릿이 있다. 
<br />
<br />
<br /></p>
<h3 id="lets-make-my-own-templete">Let’s make my own Templete</h3>

<p>조금 더 자세한 doc은 Nuclei template를 참조하고(https://nuclei.projectdiscovery.io/templating-guide), 자주 사용하게될 HTTP Request/Response 부분을 보자, 
<br />
<br /></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>id: git-config

info:
  name: Git Config File
  author: Ice3man
  severity: medium
  description: Searches for the pattern /.git/config on passed URLs.

requests:
  - method: GET
    path:
      - "/.git/config"
    matchers:
      - type: word
        words:
          - "[core]"

</code></pre></div></div>
<p><br />
<br />
http request template에서는 크게 request, matchers로 나뉜다.
<br />
<br /></p>

<p>Request</p>

<table>
  <thead>
    <tr>
      <th>Field</th>
      <th>Discription</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>method</td>
      <td>http 메소드</td>
    </tr>
    <tr>
      <td>path</td>
      <td>경로(host name)</td>
    </tr>
    <tr>
      <td>headers</td>
      <td>http header</td>
    </tr>
    <tr>
      <td>body</td>
      <td>request body값</td>
    </tr>
  </tbody>
</table>

<p><br />
<br /></p>

<p>Matches</p>

<table>
  <thead>
    <tr>
      <th>Field</th>
      <th>Discription</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>status</td>
      <td>http 리스폰스 코드</td>
    </tr>
    <tr>
      <td>size</td>
      <td>Content Length 사이즈</td>
    </tr>
    <tr>
      <td>word</td>
      <td>문자열 탐지</td>
    </tr>
    <tr>
      <td>regex</td>
      <td>regex 문자열 탐지</td>
    </tr>
    <tr>
      <td>binary</td>
      <td>바이너리</td>
    </tr>
    <tr>
      <td>dsl</td>
      <td>조건문</td>
    </tr>
  </tbody>
</table>

<p><br />
<br />
<br />
<br />
<br />
<br /></p>

<p>Tomcat examples  template,</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>id: tomcat_examples-panel

info:
  name: tomcat_examples-panel
  author: dexter
  severity: info
  
requests:
  - method: GET
    path:
      - "/examples/"
      - "/examples"
    matchers:
      - type: word
        words:
          - "&gt;Apache Tomcat"
</code></pre></div></div>

<p><img src="/assets/template_test.png" alt="template_test" /></p>

<p>잘 작동한다. :)</p>

<p>template 확장성이 좋아서 자주 애용할것 같다. 
범용적으로 사용하기 좋은 템플릿을 만들면, git pull도 올려봐야겠다.</p>


  </div></div>

    </section>
  </main>
  <script src="/assets/js/simple-jekyll-search.min.js"></script>
  <script src="/assets/js/search.js"></script>
  
</body>

</html>
